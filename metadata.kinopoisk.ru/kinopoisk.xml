<?xml version="1.0" encoding="WINDOWS-1251"?>
<scraper date="2010-02-23" framework="1.1">
	<!-- Формируем поисковый URl -->
	<CreateSearchUrl SearchStringEncoding="CP1251" dest="3">
		<RegExp input="$$1" output="&lt;url&gt;http://www.kinopoisk.ru/index.php?level=7&amp;from=forma&amp;result=adv&amp;m_act%5Bfrom%5D=forma&amp;m_act%5Bwhat%5D=content&amp;m_act%5Bfind%5D=\1&amp;m_act%5Byear%5D=$$2|User-Agent=Mozilla%2F5.0%20(X11%3B%20U%3B%20Linux%20i686%3B%20en-US%3B%20rv%3A1.8.1.14)%20Gecko%2F20080418%20Ubuntu%2F7.10%20(gutsy)%20Firefox%2F2.0.0.14&lt;/url&gt;" dest="3">
			<expression noclean="1"/>
		</RegExp>
	</CreateSearchUrl>
	<!-- Выбираем найденные совпадения -->
	<GetSearchResults dest="8">
		<RegExp input="$$5" output="&lt;?xml version=&quot;1.0&quot; encoding=&quot;windows-1251&quot; standalone=&quot;yes&quot;?&gt;&lt;results sorted=&quot;yes&quot;&gt;\1&lt;/results&gt;" dest="8">
			<!--Код если найден единственный вариант-->
			<RegExp input="$$7" output="&lt;entity&gt;\1&lt;/entity&gt;" dest="5+">
				<RegExp input="$$6" output="&lt;title&gt;\1&lt;/title&gt;" dest="7">
					<RegExp input="$$1" output="\1" dest="6">
						<expression>class="moviename-big"&gt;(.+?)&lt;/h1&gt;</expression>
					</RegExp>
					<RegExp conditional="search_originaltitle" input="$$1" output="[\1]" dest="6+">
						<expression>&lt;span style="color: #666; font-size: 13px"&gt;(.*?)&lt;/span&gt;</expression>
					</RegExp>
					<expression noclean="1"/>
				</RegExp>
				<RegExp input="$$1" output="&lt;year&gt;\1&lt;/year&gt;" dest="7+">
					<expression>&lt;td class=""&gt;&lt;a href="/level/10/m_act%5Byear%5D/\d+/"&gt;(\d+)&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;</expression>
				</RegExp>
				<RegExp input="$$1" output="&lt;url&gt;http://www.kinopoisk.ru/level/1/film/\1|User-Agent=Mozilla%2F5.0%20(X11%3B%20U%3B%20Linux%20i686%3B%20en-US%3B%20rv%3A1.8.1.14)%20Gecko%2F20080418%20Ubuntu%2F7.10%20(gutsy)%20Firefox%2F2.0.0.14&lt;/url&gt;" dest="7+">
					<expression>&lt;a href="/level/19/film/(\d+)/"&gt;</expression>
				</RegExp>
				<expression noclean="1" />
			</RegExp>
			<!--Код если найдено несколько вариантов-->
			<RegExp conditional="!search_originaltitle" input="$$1" output="&lt;entity&gt;&lt;title&gt;\2&lt;/title&gt;&lt;year&gt;\3&lt;/year&gt;&lt;url&gt;http://www.kinopoisk.ru/level\1|User-Agent=Mozilla%2F5.0%20(X11%3B%20U%3B%20Linux%20i686%3B%20en-US%3B%20rv%3A1.8.1.14)%20Gecko%2F20080418%20Ubuntu%2F7.10%20(gutsy)%20Firefox%2F2.0.0.14&lt;/url&gt;&lt;/entity&gt;" dest="5+">
				<expression repeat="yes">&lt;a class="all" href="/level(.+?)"&gt;(.+?)&lt;/a&gt;,&amp;nbsp;&lt;a[^&gt;]*&gt;([^&lt;]*)&lt;</expression>
			</RegExp>
			<RegExp conditional="search_originaltitle" input="$$1" output="&lt;entity&gt;&lt;title&gt;\2 [\4]&lt;/title&gt;&lt;year&gt;\3&lt;/year&gt;&lt;url&gt;http://www.kinopoisk.ru/level\1|User-Agent=Mozilla%2F5.0%20(X11%3B%20U%3B%20Linux%20i686%3B%20en-US%3B%20rv%3A1.8.1.14)%20Gecko%2F20080418%20Ubuntu%2F7.10%20(gutsy)%20Firefox%2F2.0.0.14&lt;/url&gt;&lt;/entity&gt;" dest="5+">
				<expression repeat="yes">&lt;a class="all" href="/level(.+?)"&gt;(.+?)&lt;/a&gt;,&amp;nbsp;&lt;a[^&gt;]*&gt;([^&lt;]*)&lt;.*?color="#999999"&gt;(.*?)&lt;</expression>
			</RegExp>
			<!-- remove &nbsp; from titles-->
			<RegExp input="$$5" output="\1&amp;nbsp;" dest="5">
				<expression noclean="1"/>
			</RegExp>
			<RegExp input="$$5" output="\1 " dest="5">
				<expression noclean="1" repeat="yes">(.*?)&amp;nbsp;</expression>
			</RegExp>
			<!-- -->
		<expression noclean="1" trim="1"/>
		</RegExp>
	</GetSearchResults>
	<GetDetails clearbuffers="no" dest="3">
		<RegExp input="$$5" output="&lt;?xml version=&quot;1.0&quot; encoding=&quot;windows-1251&quot; standalone=&quot;yes&quot;?&gt;&lt;details&gt;\1&lt;/details&gt;" dest="3">
			<!--TITLE-->
			<RegExp input="$$1" output="&lt;title&gt;\1&lt;/title&gt;" dest="5">
				<expression trim="1">&lt;title&gt;(.+?)&lt;/title&gt;</expression>
			</RegExp>
			<!--ORIGINALTITLE-->
			<RegExp input="$$1" output="&lt;originaltitle&gt;\1&lt;/originaltitle&gt;" dest="6">
				<expression trim="1">&lt;span style="color: #666; font-size: 13px"&gt;(.*?)&lt;/span&gt;</expression>
			</RegExp>
			<!--fix &nbsp-->
			<RegExp input="$$6" output="\1&amp;nbsp;" dest="6">
				<expression noclean="1"/>
			</RegExp>
			<RegExp input="$$6" output="\1 " dest="5+">
				<expression noclean="1" repeat="yes">(.*?)&amp;nbsp;</expression>
			</RegExp>
			<!-- -->
			<!--COUNTRY-->
			<RegExp input="$$1" output="&lt;country&gt;\1&lt;/country&gt;" dest="5+">
				<expression repeat="yes">&lt;a href="/level/10/m_act%5Bcountry%5D/.+?/"&gt;&lt;img src="/images/flags/flag.*?alt="(.*?)"</expression>
			</RegExp>
			<!--YEAR-->
			<RegExp input="$$1" output="&lt;year&gt;\1&lt;/year&gt;" dest="5+">
				<expression>&lt;td class=""&gt;&lt;a href="/level/10/m_act%5Byear%5D/\d+/"&gt;(\d+)&lt;/a&gt;</expression>
			</RegExp>
			<!--TOP250-->
			<RegExp input="$$1" output="&lt;top250&gt;\1&lt;/top250&gt;" dest="5+">
				<expression>Top250: &lt;a[^&gt;]+&gt;([0-9]*)&lt;/a&gt;</expression>
			</RegExp>
			<!--Рейтинг MPAA-->
			<RegExp input="$$1" output="&lt;mpaa&gt;\1&lt;/mpaa&gt;" dest="5+">
				<expression>&lt;tr&gt;&lt;td class="type"&gt;[^&lt;]+MPAA&lt;/td&gt;&lt;td[^&gt;]+&gt;&lt;a href=&apos;.+?/rn/(.+?)/&apos;</expression>
			</RegExp>
			<!--TAGLINE-->
			<RegExp input="$$1" output="&lt;tagline&gt;\1&lt;/tagline&gt;" dest="5+">
				<expression>&lt;td style="color: #555"&gt;&amp;laquo;(.+?)&amp;raquo;&lt;/td&gt;&lt;/tr&gt;</expression>
			</RegExp>
			<!--RUNTIME-->
			<RegExp input="$$1" output="&lt;runtime&gt;\1&lt;/runtime&gt;" dest="5+">
				<expression>&lt;td class="time" id="runtime"&gt;([0-9]+)</expression>
			</RegExp>
			<!--Рейтинг IMDB-->
			<RegExp input="$$1" output="&lt;rating&gt;\1&lt;/rating&gt;&lt;votes&gt;\2&lt;/votes&gt;" dest="5+">
				<expression>IMDB: ([0-9.]+) \(([0-9\s]+)\)&lt;/div&gt;</expression>
			</RegExp>
			<!--GENRE-->
			<RegExp input="$$1" output="&lt;genre&gt;\1&lt;/genre&gt;" dest="5+">
				<expression repeat="yes">&lt;a href="/level/10/m_act%5Bgenre%5D/\d+/"&gt;([^&gt;]*)&lt;/a&gt;</expression>
			</RegExp>
			<!--STUDIO-->
			<RegExp input="$$1" output="&lt;url function=&quot;STUDIOS&quot;&gt;http://www.kinopoisk.ru\1&lt;/url&gt;" dest="5+">
				<expression>"(/level/91/film/\d+/)"</expression>
			</RegExp>
			<!--PEOPLE-->
			<RegExp input="$$1" output="&lt;url function=&quot;PEOPLE&quot;&gt;http://www.kinopoisk.ru/level/19/film/\1&lt;/url&gt;" dest="5+">
				<expression>href="/level/19/film/(\d+)/"</expression>
			</RegExp>
			<!--PLOT and OUTLINE-->
			<RegExp input="$$1" output="" dest="6">
				<expression/>
			</RegExp>
			<RegExp input="$$1" output="\1" dest="6">
				<expression noclean="1">&lt;tr&gt;&lt;td colspan=3 style="padding: 10px 10px 20px 20px" class="news"&gt;\s+&lt;span class="_reachbanner_"&gt;[\t\n]*(.*?)[\t\n]*&lt;/span&gt;</expression>
			</RegExp>
			<!-- fixing html entities in html -->
			<RegExp input="$$6" output="\1&amp;#133;&amp;laquo;&amp;raquo;&amp;mdash;&amp;nbsp;&lt;=end=&gt;" dest="6">
				<expression noclean="1" />
			</RegExp>
			<RegExp input="$$3" output="&lt;outline&gt;\1&lt;/outline&gt;&lt;plot&gt;\1&lt;/plot&gt;" dest="5+">
				<RegExp input="$$6" output="\1 " dest="3">
					<expression repeat="yes" noclean="1">(.*?)(?:&lt;br /&gt;\r\n|&lt;br&gt;|&lt;=end=&gt;)</expression>
				</RegExp>
				<RegExp input="$$3" output="\1 " dest="3">
					<expression repeat="yes" noclean="1">(.*?)&amp;nbsp;</expression>
				</RegExp>
				<RegExp input="$$3" output="\1&amp;#x2014;" dest="3">
					<expression repeat="yes" noclean="1">(.*?)(?:&amp;mdash;|&amp;#151;)</expression>
				</RegExp>
				<RegExp input="$$3" output="\1&amp;#xBB;" dest="3">
					<expression repeat="yes" noclean="1">(.*?)&amp;raquo;</expression>
				</RegExp>
				<RegExp input="$$3" output="\1&amp;#xAB;" dest="3">
					<expression repeat="yes" noclean="1">(.*?)&amp;laquo;</expression>
				</RegExp>
				<RegExp input="$$3" output="\1&amp;#x2026;" dest="3">
					<expression repeat="yes" noclean="1">(.*?)(?:&amp;#133;|&amp;hellip;)</expression>
				</RegExp>
				<expression trim="1">(.*)&amp;#x2026;</expression>
			</RegExp>
			<!-- -->
			<!--POSTERS-->
			<RegExp input="$$1" output="&lt;url function=&quot;GMP&quot;&gt;http://www.kinopoisk.ru\1&lt;/url&gt;" dest="5+">
				<expression>href="(/level/17/film/([0-9]+)/)"</expression>
			</RegExp>
			<!--TRAILER-->
			<RegExp conditional="download_trailer" input="$$2" output="\1" dest="5+">
				<RegExp input="$$1" output="&lt;country&gt;\1&lt;/country&gt;" dest="9">
					<expression repeat="yes">&lt;a href="/level/10/m_act%5Bcountry%5D/.+?/"&gt;&lt;img src="/images/flags/flag.*?alt="(.*?)"</expression>
				</RegExp>
				<RegExp input="$$9" output="true" dest="9">
					<expression>Россия</expression>
				</RegExp>
				<!-- Если фильм произведён в России, то выбираем первый трейлер -->
				<RegExp input="$$9"  output="$$4" dest="2">
					<RegExp input="$$1" output="&lt;url function=&quot;GMT_Russia&quot;&gt;http://www.kinopoisk.ru/level/16/film/\1&lt;/url&gt;" dest="4">
						<expression>&lt;a href="/level/16/film/(\d+)/"&gt;</expression>
					</RegExp>
					<expression>^true$</expression>
				</RegExp>
				<!-- Если фильм произведён не в России, то выбираем русский трейлер -->
				<RegExp input="$$9" output="$$3" dest="2">
					<RegExp input="$$1" output="&lt;url function=&quot;GMT&quot;&gt;http://www.kinopoisk.ru/level/16/film/\1&lt;/url&gt;" dest="3">
						<expression>&lt;a href="/level/16/film/(\d+)/"&gt;</expression>
					</RegExp>
					<expression>^&lt;country&gt;</expression>
				</RegExp>
				<!-- -->
				<expression noclean="1" />
			</RegExp>
			<!--IMDBID functions-->
			<RegExp input="$$4" output="&lt;url cache=&quot;tmdb_\2.html&quot; function=&quot;GetIMDBID&quot;&gt;http://www.imdb.com/search/title?release_date=\1,\1&amp;title=\2&lt;/url&gt;" dest="5+">
				<RegExp input="$$1" output="\2:::\1" dest="4">
					<expression>&lt;span style="color: #666; font-size: 13px"&gt;(.+?)&lt;/span&gt;.+&lt;td class=""&gt;&lt;a href="/level/10/m_act%5Byear%5D/[0-9]+/"&gt;([0-9]+)&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;</expression>
				</RegExp>
				<RegExp input="$$4" output="\1&amp;nbsp;" dest="4">
					<expression noclean="1"/>
				</RegExp>
				<RegExp input="$$4" output="\1 " dest="4">
					<expression noclean="1" repeat="yes">(.*?)&amp;nbsp;</expression>
				</RegExp>
				<expression encode="2" trim="2">([0-9]+):::(.+)</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GetDetails>
	<GMP dest="4">
		<RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4+">
			<RegExp input="$$1" output="&lt;thumb preview=&quot;http://www.kinopoisk.ru/images/poster/sm_\1&quot;&gt;http://www.kinopoisk.ru/images/poster/\1&lt;/thumb&gt;" dest="8+">
				<expression repeat="yes" noclean="1">&lt;a href="/picture/[0-9]+/"&gt;&lt;img  src="/images/poster/sm_([^"]+)" width</expression>
			</RegExp>
			<RegExp input="$$1" output="\1" dest="7">
				<expression noclean="1">&lt;div class="navigator"&gt;(.*?)&lt;/div&gt;</expression>
			</RegExp>
			<RegExp input="$$7" output="&lt;url function=&quot;GMP_SINGLE&quot;&gt;http://www.kinopoisk.ru\1&lt;/url&gt;" dest="8+">
				<expression repeat="yes" noclean="1">&lt;li &gt;&lt;a href="(/level/17/film/\d+/page/\d+/)">\d+&lt;/a&gt;&lt;/li&gt;</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GMP>
	<GMP_SINGLE dest="4">
		<RegExp input="$$8" output="&lt;details&gt;\1&lt;/details&gt;" dest="4+">
			<RegExp input="$$1" output="&lt;thumb preview=&quot;http://www.kinopoisk.ru/images/poster/sm_\1&quot;&gt;http://www.kinopoisk.ru/images/poster/\1&lt;/thumb&gt;" dest="8+">
				<expression repeat="yes" noclean="1">&lt;a href="/picture/[0-9]+/"&gt;&lt;img  src="/images/poster/sm_([^"]+)" width</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GMP_SINGLE>
	<GMT_Russia dest="4">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="&lt;trailer tilte=&quot;\1&quot;&gt;&lt;html&gt;\2&lt;/html&gt;&lt;/trailer&gt;" dest="3">
				<expression repeat="yes" noclean="2">&lt;a href="/level/16/film/[^"]+" class="all"&gt;(.*?)&lt;/a&gt;(.*?)&lt;!-- /ролик</expression>
			</RegExp>
			<RegExp input="$$3" output="\1" dest="3">
				<expression noclean="1">tilte="Трейлер"(.*?)&lt;/trailer&gt;</expression>
			</RegExp>
			<!-- NOT HD TRAILERS-->
			<RegExp input="$$3" output="&lt;trailer quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5">
				<expression repeat="yes">&lt;td width=20&gt;&lt;/td&gt;.*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
			</RegExp>
			<!-- HD TRAILERS-->
			<RegExp conditional="download_hd" input="$$3" output="&lt;trailer type=&quot;HD&quot; quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5+">
				<expression repeat="yes">&lt;td width=20&gt;&lt;img src="/images/icon-hd2.gif".*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
			</RegExp>
			<!-- Пытаемся выбрать предпочитаемое качество-->
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>High</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>Medium</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>Low</expression>
			</RegExp>
			<!-- Выбираем последний найденный трейлер (вероятно он имеет максимальное качество) на случай если нету предпочтительного качества-->
			<RegExp input="$$5" output="&lt;trailer id=&quot;best&quot; &gt;\1&lt;/trailer&gt;" dest="2+">
				<expression>&lt;trailer.*?&gt;([^&lt;]*)&lt;/trailer&gt;$</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GMT_Russia>
	<GMT dest="4">
		<RegExp input="$$2" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="&lt;trailer tilte=&quot;\1&quot;&gt;&lt;html&gt;\2&lt;/html&gt;&lt;/trailer&gt;" dest="3">
				<expression repeat="yes" noclean="2">src="/images/flags/flag-2.gif".*?class="all"&gt;(.*?)&lt;/a&gt;(.*?)&lt;!-- /ролик</expression>
			</RegExp>
			<RegExp input="$$3" output="\1" dest="3">
				<expression noclean="1">tilte="Трейлер.*?"(.*?)&lt;/trailer&gt;</expression>
			</RegExp>
			<!-- NOT HD TRAILERS-->
			<RegExp input="$$3" output="&lt;trailer quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5">
				<expression repeat="yes">&lt;td width=20&gt;&lt;/td&gt;.*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
			</RegExp>
			<!-- HD TRAILERS-->
			<RegExp conditional="download_hd" input="$$3" output="&lt;trailer type=&quot;HD&quot; quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5+">
				<expression repeat="yes">&lt;td width=20&gt;&lt;img src="/images/icon-hd2.gif".*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
			</RegExp>
			<!-- Пытаемся выбрать предпочитаемое качество-->
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>High</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>Medium</expression>
			</RegExp>
			<RegExp input="$INFO[TrailerQ]" output="$$6" dest="2">
				<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer type="HD" quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
					<expression repeat="yes">&lt;trailer quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<expression>Low</expression>
			</RegExp>
			<!-- Выбираем последний найденный трейлер (вероятно он имеет максимальное качество) на случай если нету предпочтительного качества-->
			<RegExp input="$$5" output="&lt;trailer id=&quot;best&quot; &gt;\1&lt;/trailer&gt;" dest="2+">
				<expression>&lt;trailer.*?&gt;([^&lt;]*)&lt;/trailer&gt;$</expression>
			</RegExp>
			<!-- non-russian trailers -->
			<RegExp conditional="orig_trailer" input="$$5" output="&lt;trailer lang=&quot;orig&quot; id=&quot;best&quot; &gt;\1&lt;/trailer&gt;" dest="2+">
				<RegExp input="$$1" output="&lt;trailer tilte=&quot;\1&quot;&gt;&lt;html&gt;\2&lt;/html&gt;&lt;/trailer&gt;" dest="3">
					<expression repeat="yes" noclean="2">&lt;a href="/level/16/film/[^"]+" class="all"&gt;(.*?)&lt;/a&gt;(.*?)&lt;!-- /ролик</expression>
				</RegExp>
				<RegExp input="$$3" output="\1" dest="3">
					<expression noclean="1">tilte="Трейлер"(.*?)&lt;/trailer&gt;</expression>
				</RegExp>
				<!-- NOT HD TRAILERS-->
				<RegExp input="$$3" output="&lt;trailer quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5">
					<expression repeat="yes">&lt;td width=20&gt;&lt;/td&gt;.*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
				</RegExp>
				<!-- HD TRAILERS-->
				<RegExp conditional="download_hd" input="$$3" output="&lt;trailer type=&quot;HD&quot; quality=&quot;\2&quot;&gt;\1&lt;/trailer&gt;" dest="5+">
					<expression repeat="yes">&lt;td width=20&gt;&lt;img src="/images/icon-hd2.gif".*?&lt;a href="(?:.*?)&amp;type=trailer&amp;link=(.*?)" class="continue"&gt;(.*?)&lt;/a&gt;</expression>
				</RegExp>
				<!-- Пытаемся выбрать предпочитаемое качество-->
				<RegExp conditional="orig_trailer" input="$INFO[TrailerQ]" output="$$6" dest="2+">
					<RegExp conditional="download_hd" input="$$5" output="&lt;trailer lang=&quot;orig&quot;&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer type="HD" quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer quality="Высокое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<expression>High</expression>
				</RegExp>
				<RegExp conditional="orig_trailer" input="$INFO[TrailerQ]" output="$$6" dest="2+">
					<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer type="HD" quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer quality="Среднее качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<expression>Medium</expression>
				</RegExp>
				<RegExp conditional="orig_trailer" input="$INFO[TrailerQ]" output="$$6" dest="2+">
					<RegExp conditional="download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer type="HD" quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<RegExp conditional="!download_hd" input="$$5" output="&lt;trailer&gt;\1&lt;/trailer&gt;" dest="6">
						<expression repeat="yes">&lt;trailer quality="Низкое качество"&gt;(.*?)&lt;/trailer&gt;</expression>
					</RegExp>
					<expression>Low</expression>
				</RegExp>
				<!-- Выбираем последний найденный трейлер (вероятно он имеет максимальное качество) на случай если нету предпочтительного качества-->
				<expression>&lt;trailer.*?&gt;([^&lt;]*)&lt;/trailer&gt;$</expression>
			</RegExp>
			<!-- END non-russian trailers -->
			<expression noclean="1"/>
		</RegExp>
	</GMT>
	<STUDIOS dest="4">
		<RegExp input="$$8" output="&lt;?xml version=&quot;1.0&quot; encoding=&quot;windows-1251&quot; standalone=&quot;yes&quot;?&gt;&lt;details&gt;\1&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="\1" dest="7">
				<expression noclean="1">&lt;b&gt;Производство:&lt;/b&gt;(.*?)&lt;/table&gt;</expression>
			</RegExp>
			<RegExp input="$$7" output="&lt;studio&gt;\1&lt;/studio&gt;" dest="7">
				<expression repeat="yes">&lt;a href="/level/10/m_act\[studio\]/\d+/" class="all"&gt;(.+?)&lt;/a&gt;</expression>
			</RegExp>
			<!--fix &nbsp-->
			<RegExp input="$$7" output="\1&amp;nbsp;" dest="7">
				<expression noclean="1"/>
			</RegExp>
			<RegExp input="$$7" output="\1 " dest="8">
				<expression noclean="1" repeat="yes">(.*?)&amp;nbsp;</expression>
			</RegExp>
			<!-- -->
			<expression noclean="1"/>
		</RegExp>
	</STUDIOS>
	<PEOPLE dest="10">
		<RegExp input="$$7" output="&lt;?xml version=&quot;1.0&quot; encoding=&quot;windows-1251&quot; standalone=&quot;yes&quot;?&gt;&lt;details&gt;\1&lt;/details&gt;" dest="10">
			<RegExp input="$$1" output="\1" dest="9">
				<expression clear="yes" noclean="1">&lt;tr&gt;&lt;td colspan=3&gt;&lt;a name="actor"&gt;&lt;/td&gt;&lt;/tr&gt;.+?&lt;/table&gt;(.*?)&lt;tr&gt;&lt;td colspan=3&gt;&lt;a name="producer"&gt;&lt;/td&gt;&lt;/tr&gt;</expression>
			</RegExp>
			<RegExp input="$$9" output="&lt;n&gt;\2&lt;r&gt;\3&lt;t&gt;http://www.kinopoisk.ru/images/actor/\1&lt;/e&gt;" dest="9">
				<expression repeat="yes" trim="3">&lt;img src="/images/(?:sm_actor/([0-9]+.jpg)|no-poster.gif)" alt=.+?&lt;p&gt;&lt;a href="/level/4/people/\d+/"&gt;(.*?)&lt;/a&gt;&lt;b&gt;.*?&lt;/b&gt;... ([^&lt;,]+)</expression>
			</RegExp>
			<RegExp input="$$9" output="&lt;actor&gt;&lt;name&gt;\1&lt;/name&gt;&lt;role&gt;\2&lt;/role&gt;&lt;thumb&gt;\3&lt;/thumb&gt;&lt;/actor&gt;" dest="7">
				<expression repeat="yes" trim="3">&lt;n&gt;([^&lt;]+)&lt;r&gt;(?:играет |)([^&lt;]+)&lt;t&gt;(?:(http://www.kinopoisk.ru/images/actor/[0-9]+.jpg)&lt;/e&gt;|http://www.kinopoisk.ru/images/actor/&lt;/e&gt;)</expression>
			</RegExp>
			<!-- remove &nbsp; from actor roles -->
			<RegExp input="$$7" output="\1&amp;nbsp;" dest="7">
				<expression noclean="1"/>
			</RegExp>
			<RegExp input="$$7" output="\1 " dest="7">
				<expression noclean="1" repeat="yes">(.*?)&amp;nbsp;</expression>
			</RegExp>
			<!-- -->
			<RegExp input="$$1" output="\1" dest="8">
				<expression clear="yes" noclean="1">&lt;tr&gt;&lt;td colspan=3&gt;&lt;a name="director"&gt;&lt;/td&gt;&lt;/tr&gt;.+?&lt;/table&gt;(.*?)&lt;tr&gt;&lt;td colspan=3&gt;&lt;a name="actor"&gt;&lt;/td&gt;&lt;/tr&gt;</expression>
			</RegExp>
			<RegExp input="$$8" output="&lt;director&gt;\2&lt;/director&gt;" dest="7+">
				<expression repeat="yes" trim="3">&lt;img src="([^"]+)" alt=.+?&lt;p&gt;&lt;a href="/level/4/people/\d+/"&gt;([^&lt;]+)&lt;/a&gt;</expression>
			</RegExp>
			<RegExp input="$$1" output="\1" dest="8">
				<expression clear="yes" noclean="1">&lt;tr&gt;&lt;td colspan=3&gt;&lt;a name="writer"&gt;&lt;/td&gt;&lt;/tr&gt;(.*?)&lt;table</expression>
			</RegExp>
			<RegExp input="$$8" output="&lt;credits&gt;\2&lt;/credits&gt;" dest="7+">
				<expression repeat="yes" trim="3">&lt;img src="([^"]+)" alt=.+?&lt;p&gt;&lt;a href="/level/4/people/\d+/"&gt;([^&lt;]+)&lt;/a&gt;</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</PEOPLE>
	<GetTMDBFanartByIMDBUrl dest="4">
		<RegExp input="$$5" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="&lt;chain function=&quot;GetTMDBFanartByIdChain&quot;&gt;\2&lt;/chain&gt;" dest="5">
				<expression>(com|")/title/(tt[0-9]+)</expression>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GetTMDBFanartByIMDBUrl>
	<GetIMDBID dest="4">
		<RegExp input="$$5" output="&lt;details&gt;\1&lt;/details&gt;" dest="4">
			<RegExp input="$$1" output="\1" dest="6">
				<expression>(?:com|")/title/(tt[0-9]+)</expression>
			</RegExp>
			<RegExp input="$$6" output="&lt;id&gt;\1&lt;/id&gt;" dest="5">
				<expression/>
			</RegExp>
			<RegExp conditional="fanart" input="$$6" output="&lt;chain function=&quot;GetTMDBFanartByIdChain&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression/>
			</RegExp>
			<RegExp conditional="tmdb_poster" input="$$6" output="&lt;chain function=&quot;GetTMDBThumbsByIdChain&quot;&gt;\1&lt;/chain&gt;" dest="5+">
				<expression/>
			</RegExp>
			<expression noclean="1"/>
		</RegExp>
	</GetIMDBID>
</scraper>
